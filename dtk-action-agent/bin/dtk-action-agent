#!/usr/bin/env ruby
require 'rubygems'
require 'json'
require File.expand_path('../../lib/logger', __FILE__)
require File.expand_path('../../lib/arbiter', __FILE__)
require File.expand_path('../../lib/positioner', __FILE__)
require File.expand_path('../../lib/commander', __FILE__)

unless ARGV[0]
  error_msg = {
    :error => 'You need to provide JSON with argument to method call'
  }
  print error_msg.to_json
else
  content = JSON.parse(ARGV[0])
  arbiter = DTK::Agent::Arbiter.new(content)
  results = arbiter.run()

  # we print results in json so that they can be serialized in another
  print results.to_json
end